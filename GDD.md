# 《三國派》遊戲設計文檔 (Game Design Document)

## 1. 遊戲概述 (Game Overview)
*   **遊戲名稱**：三國派 (SanGuoPai / Three Kingdoms Poker)
*   **遊戲類型**：Roguelike 策略卡牌 / 博弈冒險
*   **核心機制**：二十一點 (Blackjack) + 武將技能組合 (Synergy) + 歷史編年史關卡
*   **目標受眾**：卡牌遊戲愛好者、三國題材粉絲、Roguelike 玩家
*   **核心體驗**：在經典博弈規則中透過策略「合法作弊」，實現從精確計算到數值割草的爽快感。

---

## 2. 核心玩法 (Core Gameplay)

### 2.1 基礎規則 (The Base)
1.  **對決形式**：玩家與敵將進行 21 點對決。
2.  **發牌**：雙方初始各發兩張牌，敵將一張明牌、一張暗牌。
3.  **玩家回合**：
    *   **要牌 (Hit)**：增加點數。每回合預設**最多要牌 3 次**（可透過武將能力提升）。
    *   **出牌 (Play Hand)**：結束回合，進入結算。此時才會判定點數是否爆牌（取代原有的停牌動作）。
    *   **錦囊 (Scheme)**：使用主動消耗品改變牌局。
4.  **敵將 AI**：
    *   不同敵將有不同 AI 傾向（如曹操狡詐、張飛莽撞）。
    *   通常在 17 點以下會強制要牌。
5.  **勝負判定**：
    *   **玩家勝**：點數 > 敵將點數且未爆牌。
    *   **平局 (Push)**：點數相同，不造成傷害也不受傷。
    *   **玩家敗**：點數 < 敵將點數，或玩家爆牌。

### 2.2 數值與傷害模型 (The Math)
*   **傷害公式**：`總傷害 = (基礎傷害 + 加法加成) × 乘法倍率`
*   **基礎傷害 (精準博弈規則)**：
    - 獲勝後之基礎傷害計算規則為：`(玩家點數 × 倍率) + 玩家手牌點數`
    - **獎勵倍率**：`10 + (21 - 玩家點數)`
        - 玩家使用的獲勝點數越小（越接近剛好贏過對手），獲得的乘法倍數越高。
        - 例如：21 點獲勝為 10x，20 點獲勝為 11x，15 點獲勝則高達 16x。
    - **手牌累積**：結算時，玩家手中所有卡牌的數值點數也會全額計入得分。
*   **出牌與棄牌次數 (Hands & Discards)**：
- **出牌次數 (Hands)**：每場戰鬥（對抗敵將）初始擁有 **3 次**出牌次數。**每次點擊「出牌」都會消耗 1 次出牌次數**。只要在用盡出牌次數前累計達成所有目標（擊敗敵將），即為勝出。
- **棄牌次數 (Discards)**：每場戰鬥初始擁有 3 次棄牌次數（可依屬性調整）。在當前回合中，玩家可主動使用棄牌功能捨棄手中不需要的牌（1 張或多張）。棄牌後不會自動補牌，需手動要牌。
*   **目標積分 (Score Target)**：
- 敵將的氣勢（Morale）視為「目標積分」。玩家獲勝時所造成的傷害會累加並扣除敵將氣勢；敵將氣勢歸零則該關卡勝出。
- **遊戲結束條件**：當出牌次數用盡（Hands 歸零）且未達成目標積分時，遊戲結束。出牌次數與棄牌次數在**進入新關卡（對抗新敵將）時會自動重置**。

---

## 3. 系統設計 (System Design)

### 3.1 武將系統 (Generals)
*   **槽位**：玩家最多可攜帶 5 名武將，結算由左至右觸發。
*   **等級劃分**：
    *   **普通 (Common)**：提供穩定基礎值（如：張角）。
    *   **精英 (Uncommon)**：具備條件觸發加成（如：夏侯惇）。
    *   **高級 (Rare)**：強大的規則修改或倍率（如：陸遜）。
    *   **傳奇 (Legendary)**：核心流派發動機（如：諸葛亮、曹操）。
*   **陣營羈絆**：
    *   **魏**：控制與棄牌。
    *   **蜀**：錦囊與反擊。
    *   **吳**：連擊與花色。
    *   **群**：隨機與風險。
*   **技能描述原則 (Skill Description Guideline)**：
    > [!IMPORTANT]
    > 武將卡牌上的技能描述應**直接呈現玩家收益**，避免使用晦澀的技能名稱。
    
    *   ❌ **避免**：「奇門遁甲：觸發天時地利之效……」
    *   ✅ **推薦**：「獲勝時 +50 傷害」「每次要牌 ×1.2 倍率」「21 點時額外 +100」
    *   卡牌上僅顯示簡潔的效果文字；詳細技能說明可在圖鑑或長按卡牌時展示。
*   **數值表與技能規範**：
    *   武將資料與技能數值見 [data/generals.json](data/generals.json)，可讀表見 [docs/武將數值表.md](docs/武將數值表.md)。
    *   技能效果與傷害公式對齊：**加法加成**加在「基礎傷害」上（可多將疊加）；**乘法倍率**乘在「(基礎傷害 + 加法加成)」上，多將倍率疊乘。
    *   觸發時機：結算時、要牌時、停牌時、達成 21 點時、爆牌時、回合開始時；每將一主技能、一觸發。
*   **管理與更換 (Management & Replacement)**：
    *   **出售 (Sell)**：玩家可隨時出售已擁有的武將。出售價格固定為該稀有度招募價格的 **50%**。
    *   **擴展槽位 (Expand Slots)**：初始擁有 5 個槽位。玩家可在招募介面花費金錢擴展槽位上限。購買價格隨次數成長（起始 $500，每次成長 1.5 倍）。

### 3.2 錦囊與寶物 (Schemes & Relics)
*   **錦囊牌**：主動消耗品，如【借東風】（看牌）、【空城計】（強制敵將停牌）。
*   **寶物**：全局被動，如【傳國玉璽】（提升稀有度出現率）。

---

## 4. 關卡與成長 (Progression)

### 4.1 編年史關卡 (Chronicle Campaign)
遊戲按歷史進程劃分多個戰役，數值隨進度平滑成長：
1.  **黃巾之亂**：基礎教學（程遠志、鄧茂等），過關所需士氣 100-500。
2.  **討伐董卓**：引入倍率概念，過關所需士氣 5000-15000。
3.  **群雄逐鹿**：陣營特色顯現，过关所需$ 5000-100000。
4.  **官渡之戰**：策略組合深化，过关所需$ 100000-500000。
5.  **赤壁之戰**：第一階段巔峰，过关所需$ 500000-2000000。
6.  **三國鼎立/北伐**：終極挑戰，过关所需$ 2000000+。

敵將數值與前 10 關配置（氣勢、AI 閾值、傾向）見 [data/enemies.json](data/enemies.json)、[docs/敵將數值表.md](docs/敵將數值表.md)。

### 2.3 進程與獎勵 (Progression & Rewards)
1. **初始資金**：原型初始擁有 $0，主要透過戰鬥獲勝獲取。
2. **獲勝獎勵 ($)**：玩家每場獲勝所造成的傷害會轉化為同等數值的 **金錢 ($)**。
3. **招募武將 (Market)**：擊敗敵將後，進入招募介面。
   - **常規招募**：從隨機池中選擇。
   - **BOSS 招募**：擊敗特定的敵方將領（如程遠志、鄧茂等）後，有 **25% 的機率** 在獎勵頁面出現該將領的招募選項。
   - **定價**：根據稀有度定價（Common: $100 / Uncommon: $250 / Rare: $600 / Legendary: $1500）。
4. **武將槽位**：初始 5 名。可透過購買擴展。
5. **交互優化**：點擊遊戲介面頂部任一武將卡牌（我方或敵方），可彈出詳情分頁查看武將插圖、技能數值、AI 性格與歷史背景。

### 再戰與失敗
1. **失敗重置**：玩家戰敗後點擊「再試一次」會重置所有進度（包含已購買武將、金錢與關卡進度），開啟全新的冒險軌跡。

---

## 5. 視覺與美術風格 (Art & Aesthetics)

*   **UI 佈局 (Layout)**：
    - **頂部**：當前擁有的武將卡牌。
    - **左側**：玩家目前的氣勢點數 (HP)。
    - **中央**：戰鬥區域（手牌與積分目標）。
    - **底部/浮層**：詳細結算介面（點數計算分解）。

*   **視覺風格**：像素畫。
*   **UI 設計**：古樸木質或竹簡質感，數值跳動時具備強烈打擊感。
*   **音效**：古琴、戰鼓，結算時伴隨刀劍碰撞聲。

---

## 6. 擴展性與重玩價值 (Replayability)
*   **難度階梯**：解鎖「天時、地利、人和」等不同難度等級。
*   **無盡模式**：通關後開啟，挑戰數值極限。
*   **解鎖要素**：達成成就解鎖新武將與新錦囊。


## 7. 技術方案 (Technical Stack)
*   **核心架構**：Electron + HTML5 / CSS3 / JavaScript (ES6+)。
*   **目標平台**：PC (Steam 分發)。
*   **渲染方式**：DOM / Canvas (預留像素畫縮放比例，確保縮放不模糊)。

## 8. 後續開發
*   **原型開發**：實作一個基於 Electron 的可玩 21 點戰鬥 Demo。
*   **數值優化**：調整遊戲平衡性。
*   **存檔系統**：延後至原型完成後處理。
