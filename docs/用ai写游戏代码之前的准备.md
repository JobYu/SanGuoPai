# 用 AI 写游戏代码之前的准备

我最近在筹备一个三国题材的 21 点 Roguelike 卡牌游戏《三国派》。在真正动手写代码之前，我和 AI 先做了一轮「原型开发前的讨论」，把技术选型、玩法边界、规则细则和 AI 行为都敲定并写成文档。这篇文章用第一人称记录这段准备工作，以及我为什么觉得这些步骤对「用 AI 写游戏代码」很重要。

---

## 为什么要先准备再写代码？

AI 很擅长根据上下文生成代码，但上下文如果模糊，它就会猜：猜你要做单局还是多局、猜伤害怎么扣、猜敌人是笨还是聪明。猜错的代价是反复改需求、改界面、改逻辑。所以我倾向在写第一行游戏代码之前，先把自己和 AI 的「共识」写下来：技术栈、原型范围、规则与行为规格。这样后续不管是自己写还是让 AI 写，都有一份单一的事实来源，减少来回扯皮。

---

## 一、技术栈与平台先定案

我选了 **Electron + HTML/CSS/JavaScript**。理由很简单：调试方便，而且我之前已经用同一套技术栈跑通过从开发到打包上架 Steam 的完整流程（当时做的是图片处理软件，不是游戏）。这样做可以少踩一次「选型→打包→上架」的坑，把精力放在玩法和数值上。

这一点我写进了项目的 GDD 和计划里，方便之后任何协作者或 AI 知道：这个项目是桌面应用、用 Electron、目标是 Steam，而不是 Web 小游戏或手机 App。

---

## 二、原型范围要收敛

「先做一个能玩的 Demo」听起来简单，但如果不划清边界，很容易越做越大。我和 AI 一起列了一张表，把原型的 MVP 定下来：

- **对战**：多场连续，同一敌将气势扣完为止（不是只打一局就结束）。
- **武将**：5 个槽位 + 选将界面，不是固定单将。
- **技能**：参考小丑牌 (Balatro) 的设计——拿到武将牌技能就生效，条件触发的必须满足条件；玩家和系统都亮牌后结算，玩家能清楚看到触发效果。
- **锦囊、宝物、商店、大地图**：原型一律不做，先固定一关。

这样一来，AI 在写「选将界面」「多局结算」「技能触发时机」时，就有明确范围，不会突然冒出「要不要顺便做商店」这种问题。

---

## 三、规则写进文档，别留在脑子里

21 点的规则大家好像都懂，但一实现就会发现细节没定：牌组几张？A 怎么算？玩家有多少血？扣多少？我要求把这些都写进规则文档（我们最后产出了 `docs/规则细则.md`），包括：

- 牌组：标准 52 张，一局一洗；之后通关模式再考虑多副牌。
- A：可算 1 或 11，取最有利且不爆。
- 玩家气势：初始 100，结算时「伤害多少扣多少」。

并且和 GDD 里的伤害公式、胜负判定对齐，避免文档和代码各说各话。对 AI 来说，有一份明确的规则文档，它生成「结算逻辑」「伤害计算」时就有依据，也方便之后做单元测试或数值平衡。

---

## 四、敌将 AI 的行为要可说清楚

敌将不是「17 以下必要牌、以上必停」就能打发的，我们希望不同敌将有不同性格（莽撞、稳健、狡诈），而且要有随机性和「看玩家牌」的调整。这些如果只口头说，AI 实现时很容易变成硬编码或乱猜。所以我们在 `docs/敌将数值表.md` 里加了一节「AI 决策规则」：

- 用阈值 + 倾向权重，而不是必 Hit/必 Stand；
- AI 会根据玩家明牌调整（例如狡诈在玩家 20 点时更倾向要牌）；
- 附上简单的决策流程伪代码，方便直接对应成程序。

这样 AI 在写「敌将回合」时，就有规格可依，而不是自己发明一套逻辑。

---

## 五、单局流程与画面先画出来

原型要实现的画面与状态，我们也写死成一条线：

> 游戏开始画面 → 进入战斗（游戏画面）→ 发牌 → 玩家要牌/过牌 → 敌方回合 → 结算（伤害/气势）→ 胜负判定 → 下一局或结束

这条流程放进规则文档里，之后不管是自己做状态机还是让 AI 设计，都有一个共同的「地图」，不会漏掉「结算后要刷新气势」或「平局怎么处理」这类步骤。

---

## 六、美术与占位策略

我明确了原型阶段用「纯程序 + 占位图/色块/文字」即可，不追求像素美术完成度。但有一点要预留：**像素画游戏美术的放大倍数**。例如 canvas 或 CSS 的缩放比例、点阵图放大不糊的设置，先想好或留好接口，之后换成正式美术时才不会大改。这也写进了计划，提醒自己（或 AI）在写 UI 时别把尺寸写死。

---

## 七、存档与进度延后

存档、关卡选择、大地图这些都列为「延后」，不放在原型里。这样可以专心把「一关、多局、选将、技能、结算」跑通，再考虑进度与存读档。

---

## 小结：准备好了再让 AI 写

对我来说，「用 AI 写游戏代码」的前提是：**先用人类可读的文档把游戏讲清楚**。技术栈、原型范围、规则细则、AI 行为规格、单局流程、美术策略，能写的我都写下来了。这样做有两个好处：一是自己思路更清晰，二是 AI 生成代码时有据可查，减少误解和返工。如果你也在用 AI 做游戏，不妨在写第一行游戏逻辑之前，先花一点时间做一轮「原型开发前的讨论」，把上述几类问题定下来并落成文档，再开始写——或者让 AI 开始写。
